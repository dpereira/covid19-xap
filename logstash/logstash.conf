input {
    file {
        type => "file"
        id => "csv"
        path => "/data/*.csv"
        start_position => "beginning"
    }
}

filter {
    if [type] == "file" {
        grok {
            match => { "path" => "%{GREEDYDATA}/%{GREEDYDATA:index}.csv" }
        }
    }

    if [index] == "caso" {
        csv {
            autodetect_column_names => true
        }
    }

    if [index] == "boletim" {
        csv {
            autodetect_column_names => true
        }
    }

    if [index] == "obito_cartorio" {
        csv {
            autodetect_column_names => true
        }
    }
}

output {
    elasticsearch {
        hosts => ["elasticsearch"]
        index => "%{index}"
    }

    stdout {
        codec => rubydebug
    }
}

